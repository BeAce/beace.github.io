{"data":{"site":{"siteMetadata":{"title":"Beace Blog","author":"Beace Lee"}},"markdownRemark":{"id":"12ecc118-acb9-552a-adb7-349fab55d8ab","html":"<h1>Math.random()</h1>\n<h2>伪随机</h2>\n<p><code class=\"language-text\">Math.random()</code>返回的是一个<strong>左闭右开</strong> <code class=\"language-text\">[0,1)</code>的伪随机浮点数。之所以称作伪随机，是因为整个过程看起来像是最随机的，如下图，我们也看到了随机数的分布。但是实际上并不是。不是的原因是——我们是借助一个固定的方法来获取数据。并且数据最终是可控的，因为我们固定了它的区间。</p>\n<!--more-->\n<p>虽然我们借助了原生的API来进行随机数的选取，但是，函数本身具有<code class=\"language-text\">round-to-nearest-even</code>的特性，所以严格意义上来说并不精确。</p>\n<p>还有一个原因也会导致不精确的问题就是计算机是以二进制的移位、取反、进位等操作来计算，尤其是浮点数之间的计算，不可能保证百分之百的精确，例如下面这段代码，就能够解释这一问题。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token number\">2.3</span><span class=\"token operator\">/</span><span class=\"token number\">10</span> <span class=\"token comment\">//0.22999999999999998</span></code></pre></div>\n<blockquote>\n<p>在计算伪随机数时假如使用的开始值不变的话，那么伪随机数的数序也不变。伪随机数的随机性可以用它的统计特性来衡量，其主要特征是每个数出现的可能性和它出现时与数序中其它数的关系。伪随机数的优点是它的计算比较简单，而且只使用少数数值很难推算出计算它的算法。一般人们使用一个假的随机数，比如电脑上的时间作为计算伪随机数的开始值。\n——<a href=\"https://zh.wikipedia.org/wiki/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%80%A7\">维基百科-伪随机性</a></p>\n</blockquote>\n<p><img src=\"https://images-manager.oss-cn-shanghai.aliyuncs.com/static/Math.random/math.random.png\" alt=\"Math.random()\"></p>\n<p>假设选取区间足够大，随机性就比较高，可靠性也比较强。就可以<strong>忽略边界值</strong>的问题。</p>\n<h2>随机数</h2>\n<p>了解了随机数原理，我们可以尝试来进行随机数的选取。可以简单的通过<code class=\"language-text\">Math.random() * n</code>的方式来进行定义随机数的区间范围。</p>\n<ul>\n<li><code class=\"language-text\">[0, n)</code>随机数选取</li>\n</ul>\n<p>下图是选取了<code class=\"language-text\">[0,5)</code>范围内的随机浮点数。</p>\n<p><img src=\"https://images-manager.oss-cn-shanghai.aliyuncs.com/static/Math.random/math.random*n.png\" alt=\"Math.random() * n\"></p>\n<ul>\n<li><code class=\"language-text\">[m, n]</code>随机数选取</li>\n</ul>\n<p>下图是选取了<code class=\"language-text\">[m, n]</code>范围内的随机浮点数。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//m n 为整形</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getM2NRandom</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> m<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> m<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"https://images-manager.oss-cn-shanghai.aliyuncs.com/static/Math.random/math.random.mn.png\" alt=\"Math.random() * (m -n) + m\"></p>\n<h2>取整数</h2>\n<p>在实际的<code class=\"language-text\">JavaScript</code>开发当中，往往讨论不到或者说用不到这么高深的问题。并且经常会选取随机整数来进行计算。可以借助<code class=\"language-text\">JavaScript</code>的函数来解决这样的场景。不过在这之前，先来回顾下取整函数。</p>\n<ul>\n<li><code class=\"language-text\">Math.ceil()</code></li>\n</ul>\n<p>如果是浮点数，直接取浮点数的<code class=\"language-text\">整数+1</code>，可以看做是向上取整，或向后取整。如果是整数，或者小数位全是<code class=\"language-text\">0</code>,就是其本身</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.44444</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 3</span>\nMath<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.99944</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 3</span>\nMath<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">Math.floor()</code></li>\n</ul>\n<p>如果是浮点数，直接取浮点数的<code class=\"language-text\">整数部分</code>，可以看做是向下取整，或者是向前取整。如果是整数,或者小数位全是<code class=\"language-text\">0</code>,就是其本身。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.44444</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span>\nMath<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span><span class=\"token number\">2.99944</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 2</span>\nMath<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//2</span></code></pre></div>\n<h2>随机整数</h2>\n<ul>\n<li><code class=\"language-text\">[0, n)随机取整</code></li>\n</ul>\n<p>在了解随机数和取整之后，就可以进行随机取整了。例如如下代码。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getIntRandom</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">getIntRandom</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"https://images-manager.oss-cn-shanghai.aliyuncs.com/static/Math.random/math.random.int.png\" alt=\"math.random.int\"></p>\n<ul>\n<li><code class=\"language-text\">[m, n]</code>随机取整</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getIntM2NRandom</span><span class=\"token punctuation\">(</span>m <span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">-</span> m <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> n<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">getIntM2NRandom</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"https://images-manager.oss-cn-shanghai.aliyuncs.com/static/Math.random/math.random.int.mn.png\" alt=\"math.random.int.mn\"></p>\n<p>这样的随机取整方式，也解决了取不到n的问题。</p>\n<h2>实际应用</h2>\n<p>从n个人中随机抽取m个人（m &#x3C; n）,抽奖代码。以下代码截取自<code class=\"language-text\">月影博客</code>的<code class=\"language-text\">5分钟现场撸代码——谈总结会抽奖程序</code>（<a href=\"https://www.h5jun.com/post/luckey-draw-in-5-minutes.html%EF%BC%89\">https://www.h5jun.com/post/luckey-draw-in-5-minutes.html）</a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//初始化一个 1~62 的数组</span>\n<span class=\"token keyword\">const</span> cards <span class=\"token operator\">=</span> <span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">62</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">fill</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span>i<span class=\"token punctuation\">)</span><span class=\"token operator\">=></span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 一次抽取 n 个，默认一次 1 个</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">draw</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> ret <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> idx <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>cards<span class=\"token punctuation\">.</span>length <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        ret<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>cards<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>idx<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> ret<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">//抽取一次，10个中奖者</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">draw</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"JavaScript-Math.random()","date":"February 22, 2017"}}},"pageContext":{"slug":"/2017-02-22-JavaScript-Math.random()/","previous":{"fields":{"slug":"/2017-02-21- ECMAScript 2015 Features-c08-set-map/"},"frontmatter":{"title":"ECMAScript 2015 Features-c08-set-map"}},"next":{"fields":{"slug":"/2017-02-23-EJS在script标签中混合JavaScript代码的问题/"},"frontmatter":{"title":"EJS在script标签中混合JavaScript代码的问题"}}}}