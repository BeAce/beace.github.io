{"data":{"site":{"siteMetadata":{"title":"Beace Blog","author":"Beace Lee"}},"markdownRemark":{"id":"b1a58d71-b2ec-5424-826d-7b115de49efa","html":"<hr>\n<p>title: React HashHistory url参数问题\ndate: Mon Jun 27 2016 00:00:00 GMT+0800 (CST)\nupdated: Thu Sep 22 2016 20:31:23 GMT+0800 (CST)\ncomments: 1\ncategories:\ntags: [[object Object],[object Object]]\npermalink: react-hashhistory-url</p>\n<hr>\n<h3>问题描述</h3>\n<p>在引用</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Route<span class=\"token punctuation\">,</span>Router<span class=\"token punctuation\">,</span>hashHistory<span class=\"token punctuation\">,</span>useRouterHistory<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router'</span></code></pre>\n      </div>\n<p>时，浏览器的<code class=\"language-text\">url</code>会自动生成一个<code class=\"language-text\">params</code>，如同：</p>\n<p><code class=\"language-text\">localhost:8080/about?_key23423</code></p>\n<p>这是为了兼容低版本的浏览器不支持<code class=\"language-text\">browserhistory</code>的做法，但是在<code class=\"language-text\">url</code>中会觉得好像<code class=\"language-text\">get</code>或<code class=\"language-text\">post</code>了某个参数。\n官方的解释是：</p>\n<blockquote>\n<p>The URLs in our app right now are built on a hack: the hash. Its the default because it will always work, but there’s a better way.（better way说的是browserHistory）</p>\n</blockquote>\n<!--more-->\n<h3>解决方案：</h3>\n<p>如果要坚持使用<code class=\"language-text\">hashHistory</code>这种做法定义路由又不想要<code class=\"language-text\">hash</code>值，可以自定义<code class=\"language-text\">history</code>把后面的<code class=\"language-text\">hash</code>值去掉，做法如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>Route<span class=\"token punctuation\">,</span>Router<span class=\"token punctuation\">,</span>hashHistory<span class=\"token punctuation\">,</span>useRouterHistory<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>createHashHistory<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'history'</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/App'</span>\n<span class=\"token keyword\">import</span> About <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/About.js'</span>\n<span class=\"token keyword\">import</span> Repos <span class=\"token keyword\">from</span> <span class=\"token string\">'./modules/Repos.js'</span>\n\n<span class=\"token keyword\">const</span> appHashHistory <span class=\"token operator\">=</span> <span class=\"token function\">useRouterHistory</span><span class=\"token punctuation\">(</span>createHashHistory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>queryKey<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>\n   <span class=\"token operator\">&lt;</span>Router history<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>appHashHistory<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Router path<span class=\"token operator\">=</span><span class=\"token string\">'/'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>App<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>Router path<span class=\"token operator\">=</span><span class=\"token string\">'/about'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>About<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>Router path<span class=\"token operator\">=</span><span class=\"token string\">'/repos'</span> component<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>Repos<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Router<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n      </div>\n<blockquote>\n<p>参考链接</p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://github.com/reactjs/react-router/blob/master/upgrade-guides/v2.0.0.md#using-custom-histories\">https://github.com/reactjs/react-router/blob/master/upgrade-guides/v2.0.0.md#using-custom-histories</a></p>\n</blockquote>","frontmatter":{"title":"","date":null}}},"pageContext":{"slug":"/2016-06-27-React HashHistory url参数问题/","previous":{"fields":{"slug":"/2016-07-01-React表格处理/"},"frontmatter":{"title":""}},"next":null}}